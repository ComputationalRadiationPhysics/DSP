\hypertarget{LevMarq_8h}{\section{D\-S\-P/src/\-Lev\-Marq.h File Reference}
\label{LevMarq_8h}\index{D\-S\-P/src/\-Lev\-Marq.\-h@{D\-S\-P/src/\-Lev\-Marq.\-h}}
}
{\ttfamily \#include $<$stdlib.\-h$>$}\\*
{\ttfamily \#include $<$math.\-h$>$}\\*
{\ttfamily \#include $<$float.\-h$>$}\\*
{\ttfamily \#include $<$stdio.\-h$>$}\\*
{\ttfamily \#include \char`\"{}Types.\-h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\hypertarget{LevMarq_8h_a7b01e29f669d6beed251f1b2a547ca93}{\#define {\bfseries C\-U\-D\-A}}\label{LevMarq_8h_a7b01e29f669d6beed251f1b2a547ca93}

\item 
\hypertarget{LevMarq_8h_a3de33738fd3c7e77bffbcfaefc3e7645}{\#define {\bfseries G\-L\-O\-B\-A\-L}~\-\_\-\-\_\-global\-\_\-\-\_\-}\label{LevMarq_8h_a3de33738fd3c7e77bffbcfaefc3e7645}

\item 
\hypertarget{LevMarq_8h_a775d096fbc3988fb7ed858b79ef44e22}{\#define {\bfseries D\-E\-V\-I\-C\-E}~\-\_\-\-\_\-device\-\_\-\-\_\-}\label{LevMarq_8h_a775d096fbc3988fb7ed858b79ef44e22}

\item 
\hypertarget{LevMarq_8h_a884c794595c4aa480df9022648c29564}{\#define {\bfseries S\-H\-A\-R\-E\-D}~\-\_\-\-\_\-shared\-\_\-\-\_\-}\label{LevMarq_8h_a884c794595c4aa480df9022648c29564}

\item 
\hypertarget{LevMarq_8h_a01b46cc2cae4eee231acb7702df379db}{\#define {\bfseries L\-M\-\_\-\-M\-A\-C\-H\-E\-P}~F\-L\-T\-\_\-\-E\-P\-S\-I\-L\-O\-N}\label{LevMarq_8h_a01b46cc2cae4eee231acb7702df379db}

\item 
\hypertarget{LevMarq_8h_a2ee34e0a4f4a4b860c14a8ab07e3cec3}{\#define {\bfseries L\-M\-\_\-\-D\-W\-A\-R\-F}~F\-L\-T\-\_\-\-M\-I\-N}\label{LevMarq_8h_a2ee34e0a4f4a4b860c14a8ab07e3cec3}

\item 
\hypertarget{LevMarq_8h_a65e2a867eb21938170bb9a8a850b64ec}{\#define {\bfseries L\-M\-\_\-\-S\-Q\-R\-T\-\_\-\-D\-W\-A\-R\-F}~sqrt(F\-L\-T\-\_\-\-M\-I\-N)}\label{LevMarq_8h_a65e2a867eb21938170bb9a8a850b64ec}

\item 
\hypertarget{LevMarq_8h_a057d1d13f0effa33d81c7615e4f3664d}{\#define {\bfseries L\-M\-\_\-\-S\-Q\-R\-T\-\_\-\-G\-I\-A\-N\-T}~sqrt(F\-L\-T\-\_\-\-M\-A\-X)}\label{LevMarq_8h_a057d1d13f0effa33d81c7615e4f3664d}

\item 
\hypertarget{LevMarq_8h_a61b84f802abd9a0782dcb0c1b10e8819}{\#define {\bfseries L\-M\-\_\-\-U\-S\-E\-R\-T\-O\-L}~30$\ast$L\-M\-\_\-\-M\-A\-C\-H\-E\-P}\label{LevMarq_8h_a61b84f802abd9a0782dcb0c1b10e8819}

\item 
\hypertarget{LevMarq_8h_adcd021ac91d43a62b2cdecf9a5b971a7}{\#define {\bfseries M\-I\-N}(A, B)~(((A) $<$= (B)) ? (A) \-: (B))}\label{LevMarq_8h_adcd021ac91d43a62b2cdecf9a5b971a7}

\item 
\hypertarget{LevMarq_8h_ad935f1ff1a50822e317bdb321ce991ad}{\#define {\bfseries M\-A\-X}(A, B)~(((A) $>$= (B)) ? (A) \-: (B))}\label{LevMarq_8h_ad935f1ff1a50822e317bdb321ce991ad}

\item 
\hypertarget{LevMarq_8h_a2eb03319e5ccdc1a14b73a7d8b1724de}{\#define {\bfseries S\-Q\-R}(X)~((X) $\ast$ (X))}\label{LevMarq_8h_a2eb03319e5ccdc1a14b73a7d8b1724de}

\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$unsigned int tex$>$ }\\\-\_\-\-\_\-device\-\_\-\-\_\- float \hyperlink{LevMarq_8h_adf0c30c0f7827c9ec64081ead174e071}{get\-Sample} (float I, int I\-N\-D\-E\-X\-D\-A\-T\-A\-S\-E\-T)
\begin{DoxyCompactList}\small\item\em get\-Sample returns the y value of a given sample index \end{DoxyCompactList}\item 
\hypertarget{LevMarq_8h_ad03393f5efe8859b81b576260f3a6ab4}{{\footnotesize template$<$$>$ }\\\-\_\-\-\_\-device\-\_\-\-\_\- float {\bfseries get\-Sample$<$ 0 $>$} (float I, int I\-N\-D\-E\-X\-D\-A\-T\-A\-S\-E\-T)}\label{LevMarq_8h_ad03393f5efe8859b81b576260f3a6ab4}

\item 
\hypertarget{LevMarq_8h_a91d7e14ae07070a00aa58f3d6847bcbe}{{\footnotesize template$<$$>$ }\\\-\_\-\-\_\-device\-\_\-\-\_\- float {\bfseries get\-Sample$<$ 1 $>$} (float I, int I\-N\-D\-E\-X\-D\-A\-T\-A\-S\-E\-T)}\label{LevMarq_8h_a91d7e14ae07070a00aa58f3d6847bcbe}

\item 
\hypertarget{LevMarq_8h_af16863df00f77bd2f33bc14138db1163}{{\footnotesize template$<$$>$ }\\\-\_\-\-\_\-device\-\_\-\-\_\- float {\bfseries get\-Sample$<$ 2 $>$} (float I, int I\-N\-D\-E\-X\-D\-A\-T\-A\-S\-E\-T)}\label{LevMarq_8h_af16863df00f77bd2f33bc14138db1163}

\item 
\hypertarget{LevMarq_8h_a48c8d36e9846593589c0addeeb297e60}{{\footnotesize template$<$$>$ }\\\-\_\-\-\_\-device\-\_\-\-\_\- float {\bfseries get\-Sample$<$ 3 $>$} (float I, int I\-N\-D\-E\-X\-D\-A\-T\-A\-S\-E\-T)}\label{LevMarq_8h_a48c8d36e9846593589c0addeeb297e60}

\item 
\hypertarget{LevMarq_8h_a78cfda4ff1a00fdcd85f3bc0e30b8901}{{\footnotesize template$<$$>$ }\\\-\_\-\-\_\-device\-\_\-\-\_\- float {\bfseries get\-Sample$<$ 4 $>$} (float I, int I\-N\-D\-E\-X\-D\-A\-T\-A\-S\-E\-T)}\label{LevMarq_8h_a78cfda4ff1a00fdcd85f3bc0e30b8901}

\item 
\hypertarget{LevMarq_8h_a13d892dd61f9475b2d5f0bda4f5b772e}{{\footnotesize template$<$$>$ }\\\-\_\-\-\_\-device\-\_\-\-\_\- float {\bfseries get\-Sample$<$ 5 $>$} (float I, int I\-N\-D\-E\-X\-D\-A\-T\-A\-S\-E\-T)}\label{LevMarq_8h_a13d892dd61f9475b2d5f0bda4f5b772e}

\item 
{\footnotesize template$<$unsigned int tex$>$ }\\D\-E\-V\-I\-C\-E void \hyperlink{LevMarq_8h_a682db89fc9fd71fc08af4c6bf97b8a67}{param\-Start\-Value} (int first\-Value, int last\-Value, int index\-Dataset, float $\ast$param)
\begin{DoxyCompactList}\small\item\em param\-Start\-Value returns the parameter start values for the fit-\/function calculation \end{DoxyCompactList}\item 
D\-E\-V\-I\-C\-E void \hyperlink{LevMarq_8h_a5cd69665c6373b0e11b4d4dac1c96870}{fit\-Function} (float x, float $\ast$param, float $\ast$y)
\begin{DoxyCompactList}\small\item\em fit\-Function returns the y of a given x \end{DoxyCompactList}\item 
D\-E\-V\-I\-C\-E void \hyperlink{LevMarq_8h_a57031410d7214c2ce6569d26d313c81f}{fit\-Function\-Extremum} (float $\ast$param, float $\ast$x)
\begin{DoxyCompactList}\small\item\em fit\-Function\-Extremum returns the x of the min. or max. y value \end{DoxyCompactList}\item 
{\footnotesize template$<$unsigned int tex$>$ }\\D\-E\-V\-I\-C\-E void \hyperlink{LevMarq_8h_a2235ecaa0cb148a38acea9e88eb48c7f}{evaluate} (float $\ast$param, int count\-Data, float $\ast$fvec, int index\-Dataset, int x\-Offset, float x\-Step)
\begin{DoxyCompactList}\small\item\em evaluate calculates the residues between the given samples and the current fit-\/function \end{DoxyCompactList}\item 
D\-E\-V\-I\-C\-E void \hyperlink{LevMarq_8h_aaa2c225ad735dbaf4b949124356c7680}{qr\-Solve} (int n, float $\ast$r, int ldr, int $\ast$ipvt, float $\ast$diag, float $\ast$qtb, float $\ast$x, float $\ast$sdiag, float $\ast$wa)
\begin{DoxyCompactList}\small\item\em qr\-Solve completes the solution of the problem if it is provided with the necessary information from the qr factorization, with column pivoting, of a \end{DoxyCompactList}\item 
D\-E\-V\-I\-C\-E void \hyperlink{LevMarq_8h_ad811b4e3f21363f3411fb5bcf40f039f}{euclid\-Norm} (int n, float $\ast$x, float $\ast$result)
\begin{DoxyCompactList}\small\item\em euclid\-Norm calculates the euclidean norm of x \end{DoxyCompactList}\item 
D\-E\-V\-I\-C\-E void \hyperlink{LevMarq_8h_abb75a88e4f290d8df4960dcaa63439e2}{lmpar} (int n, float $\ast$r, int ldr, int $\ast$ipvt, float $\ast$diag, float $\ast$qtb, float delta, float $\ast$par, float $\ast$x, float $\ast$sdiag, float $\ast$wa1, float $\ast$wa2)
\begin{DoxyCompactList}\small\item\em lmpar determines a value for the parameter par such that x solves the system \end{DoxyCompactList}\item 
D\-E\-V\-I\-C\-E void \hyperlink{LevMarq_8h_a15b9d544dbbe5defd5987e65cc6d934e}{qr\-Factorization} (int m, int n, float $\ast$a, int pivot, int $\ast$ipvt, float $\ast$rdiag, float $\ast$acnorm, float $\ast$wa)
\begin{DoxyCompactList}\small\item\em qr\-Factorization uses householder transformations with column pivoting (optional) to compute a qr factorization of the m by n matrix a \end{DoxyCompactList}\item 
{\footnotesize template$<$unsigned int tex$>$ }\\D\-E\-V\-I\-C\-E void \hyperlink{LevMarq_8h_a836594da02491db5779ce3d04f0574d2}{lmdif} (int m, int n, float $\ast$x, float $\ast$fvec, float ftol, float xtol, float gtol, int maxfev, float epsfcn, float $\ast$diag, int mode, float factor, int $\ast$info, int $\ast$nfev, float $\ast$fjac, int $\ast$ipvt, float $\ast$qtf, float $\ast$wa1, float $\ast$wa2, float $\ast$wa3, float $\ast$wa4, int index\-Dataset, int x\-Offset, float x\-Step)
\begin{DoxyCompactList}\small\item\em lmdif minimizes the sum of the squares of m nonlinear functions in n variables by a modification of the levenberg-\/marquardt algorithm \end{DoxyCompactList}\item 
{\footnotesize template$<$unsigned int tex$>$ }\\D\-E\-V\-I\-C\-E void \hyperlink{LevMarq_8h_a8694039b8a2d6041fd6a6ccffea8b5a4}{max\-Value} (int count\-Data, int index\-Dataset, int $\ast$x, D\-A\-T\-A\-T\-Y\-P\-E $\ast$y)
\begin{DoxyCompactList}\small\item\em max\-Value returns the x and y where y has the greatest value \end{DoxyCompactList}\item 
{\footnotesize template$<$unsigned int tex$>$ }\\D\-E\-V\-I\-C\-E void \hyperlink{LevMarq_8h_a4d040680c6e9154dea4102a9491e7748}{average\-Value} (int start, int count, int index\-Dataset, float $\ast$y)
\begin{DoxyCompactList}\small\item\em average\-Value returns the average of all y values in a given range \end{DoxyCompactList}\item 
{\footnotesize template$<$unsigned int tex$>$ }\\D\-E\-V\-I\-C\-E void \hyperlink{LevMarq_8h_adc2eca95c3a57907e8f4a3b5ac74dad3}{x\-Of\-Value} (int count\-Data, int index\-Dataset, char from\-Direction, D\-A\-T\-A\-T\-Y\-P\-E min\-Value, int $\ast$x)
\begin{DoxyCompactList}\small\item\em x\-Of\-Value returns the first x of a value y that is greater or equal of a given min. value \end{DoxyCompactList}\item 
D\-E\-V\-I\-C\-E void \hyperlink{LevMarq_8h_adc3685405ad9238914fc836f63e860c6}{average\-Abs\-Residues} (int count\-Residues, float $\ast$residues, float $\ast$average)
\begin{DoxyCompactList}\small\item\em average\-Abs\-Residues returns the average of the residues absolute value \end{DoxyCompactList}\item 
{\footnotesize template$<$unsigned int tex$>$ }\\G\-L\-O\-B\-A\-L void \hyperlink{LevMarq_8h_acfe6a74e36f9c835b98e1773051de280}{kernel} (int count\-Data, float step, struct \hyperlink{structfitData}{fit\-Data} $\ast$result)
\begin{DoxyCompactList}\small\item\em kernel is the start method for calculation (you have to set the data\-Texture (G\-P\-U mode) or data variable (C\-P\-U mode) before calling this method) \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hypertarget{LevMarq_8h_a26e1c066f5c236659d8f457d955d10ee}{texture$<$ D\-A\-T\-A\-T\-Y\-P\-E, \\*
2, cuda\-Read\-Mode\-Element\-Type $>$ {\bfseries data\-Texture0}}\label{LevMarq_8h_a26e1c066f5c236659d8f457d955d10ee}

\item 
\hypertarget{LevMarq_8h_a1f6b7847bbc86a2b353e3b5bee51be99}{texture$<$ D\-A\-T\-A\-T\-Y\-P\-E, \\*
2, cuda\-Read\-Mode\-Element\-Type $>$ {\bfseries data\-Texture1}}\label{LevMarq_8h_a1f6b7847bbc86a2b353e3b5bee51be99}

\item 
\hypertarget{LevMarq_8h_a4b420872aa582bd229ccd220ecc19863}{texture$<$ D\-A\-T\-A\-T\-Y\-P\-E, \\*
2, cuda\-Read\-Mode\-Element\-Type $>$ {\bfseries data\-Texture2}}\label{LevMarq_8h_a4b420872aa582bd229ccd220ecc19863}

\item 
\hypertarget{LevMarq_8h_a54823b1402a2e31dabb783593cf9437a}{texture$<$ D\-A\-T\-A\-T\-Y\-P\-E, \\*
2, cuda\-Read\-Mode\-Element\-Type $>$ {\bfseries data\-Texture3}}\label{LevMarq_8h_a54823b1402a2e31dabb783593cf9437a}

\item 
\hypertarget{LevMarq_8h_ad73ae3e2dde91f009171359866f62bc1}{texture$<$ D\-A\-T\-A\-T\-Y\-P\-E, \\*
2, cuda\-Read\-Mode\-Element\-Type $>$ {\bfseries data\-Texture4}}\label{LevMarq_8h_ad73ae3e2dde91f009171359866f62bc1}

\item 
\hypertarget{LevMarq_8h_a32744f6251c18238803ccb128d1e47eb}{texture$<$ D\-A\-T\-A\-T\-Y\-P\-E, \\*
2, cuda\-Read\-Mode\-Element\-Type $>$ {\bfseries data\-Texture5}}\label{LevMarq_8h_a32744f6251c18238803ccb128d1e47eb}

\item 
const char $\ast$ {\bfseries status\-Message} \mbox{[}$\,$\mbox{]}
\end{DoxyCompactItemize}


\subsection{Detailed Description}


\subsection{Function Documentation}
\hypertarget{LevMarq_8h_adc3685405ad9238914fc836f63e860c6}{\index{Lev\-Marq.\-h@{Lev\-Marq.\-h}!average\-Abs\-Residues@{average\-Abs\-Residues}}
\index{average\-Abs\-Residues@{average\-Abs\-Residues}!LevMarq.h@{Lev\-Marq.\-h}}
\subsubsection[{average\-Abs\-Residues}]{\setlength{\rightskip}{0pt plus 5cm}D\-E\-V\-I\-C\-E void average\-Abs\-Residues (
\begin{DoxyParamCaption}
\item[{int}]{count\-Residues, }
\item[{float $\ast$}]{residues, }
\item[{float $\ast$}]{average}
\end{DoxyParamCaption}
)}}\label{LevMarq_8h_adc3685405ad9238914fc836f63e860c6}


average\-Abs\-Residues returns the average of the residues absolute value 


\begin{DoxyParams}{Parameters}
{\em count\-Residues} & number of residues \\
\hline
{\em residues} & array of length count\-Residues that contains the residues \\
\hline
{\em average} & the returned average \\
\hline
\end{DoxyParams}
\hypertarget{LevMarq_8h_a4d040680c6e9154dea4102a9491e7748}{\index{Lev\-Marq.\-h@{Lev\-Marq.\-h}!average\-Value@{average\-Value}}
\index{average\-Value@{average\-Value}!LevMarq.h@{Lev\-Marq.\-h}}
\subsubsection[{average\-Value}]{\setlength{\rightskip}{0pt plus 5cm}template$<$unsigned int tex$>$ D\-E\-V\-I\-C\-E void average\-Value (
\begin{DoxyParamCaption}
\item[{int}]{start, }
\item[{int}]{count, }
\item[{int}]{index\-Dataset, }
\item[{float $\ast$}]{y}
\end{DoxyParamCaption}
)}}\label{LevMarq_8h_a4d040680c6e9154dea4102a9491e7748}


average\-Value returns the average of all y values in a given range 


\begin{DoxyParams}{Parameters}
{\em start} & first x for average calculation \\
\hline
{\em count} & number of values for average calculation \\
\hline
{\em index\-Dataset} & index of the current dataset (G\-P\-U mode) or not used (C\-P\-U mode) \\
\hline
{\em y} & the returned average \\
\hline
\end{DoxyParams}
\hypertarget{LevMarq_8h_ad811b4e3f21363f3411fb5bcf40f039f}{\index{Lev\-Marq.\-h@{Lev\-Marq.\-h}!euclid\-Norm@{euclid\-Norm}}
\index{euclid\-Norm@{euclid\-Norm}!LevMarq.h@{Lev\-Marq.\-h}}
\subsubsection[{euclid\-Norm}]{\setlength{\rightskip}{0pt plus 5cm}D\-E\-V\-I\-C\-E void euclid\-Norm (
\begin{DoxyParamCaption}
\item[{int}]{n, }
\item[{float $\ast$}]{x, }
\item[{float $\ast$}]{result}
\end{DoxyParamCaption}
)}}\label{LevMarq_8h_ad811b4e3f21363f3411fb5bcf40f039f}


euclid\-Norm calculates the euclidean norm of x 


\begin{DoxyParams}{Parameters}
{\em n} & length of array x \\
\hline
{\em x} & array for euclidean norm \\
\hline
{\em result} & euclidean norm of x \\
\hline
\end{DoxyParams}
calculation of norm \hypertarget{LevMarq_8h_a2235ecaa0cb148a38acea9e88eb48c7f}{\index{Lev\-Marq.\-h@{Lev\-Marq.\-h}!evaluate@{evaluate}}
\index{evaluate@{evaluate}!LevMarq.h@{Lev\-Marq.\-h}}
\subsubsection[{evaluate}]{\setlength{\rightskip}{0pt plus 5cm}template$<$unsigned int tex$>$ D\-E\-V\-I\-C\-E void evaluate (
\begin{DoxyParamCaption}
\item[{float $\ast$}]{param, }
\item[{int}]{count\-Data, }
\item[{float $\ast$}]{fvec, }
\item[{int}]{index\-Dataset, }
\item[{int}]{x\-Offset, }
\item[{float}]{x\-Step}
\end{DoxyParamCaption}
)}}\label{LevMarq_8h_a2235ecaa0cb148a38acea9e88eb48c7f}


evaluate calculates the residues between the given samples and the current fit-\/function 


\begin{DoxyParams}{Parameters}
{\em param} & parameters to define the concrete current fit-\/function \\
\hline
{\em count\-Data} & number of samples \\
\hline
{\em fvec} & the returned residues \\
\hline
{\em index\-Dataset} & index of the current dataset (G\-P\-U mode) or not used (C\-P\-U mode) \\
\hline
{\em x\-Offset} & first x value that is used to calculate the fit-\/function \\
\hline
{\em x\-Step} & the distance between two x values that are used to calculate the fit-\/function (if decimal then y values will be interpolated) \\
\hline
\end{DoxyParams}
\hypertarget{LevMarq_8h_a5cd69665c6373b0e11b4d4dac1c96870}{\index{Lev\-Marq.\-h@{Lev\-Marq.\-h}!fit\-Function@{fit\-Function}}
\index{fit\-Function@{fit\-Function}!LevMarq.h@{Lev\-Marq.\-h}}
\subsubsection[{fit\-Function}]{\setlength{\rightskip}{0pt plus 5cm}D\-E\-V\-I\-C\-E void fit\-Function (
\begin{DoxyParamCaption}
\item[{float}]{x, }
\item[{float $\ast$}]{param, }
\item[{float $\ast$}]{y}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{LevMarq_8h_a5cd69665c6373b0e11b4d4dac1c96870}


fit\-Function returns the y of a given x 


\begin{DoxyParams}{Parameters}
{\em x} & given x value to calculate y \\
\hline
{\em param} & parameters to define the concrete current fit-\/function \\
\hline
{\em y} & the returned y value \\
\hline
\end{DoxyParams}
\hypertarget{LevMarq_8h_a57031410d7214c2ce6569d26d313c81f}{\index{Lev\-Marq.\-h@{Lev\-Marq.\-h}!fit\-Function\-Extremum@{fit\-Function\-Extremum}}
\index{fit\-Function\-Extremum@{fit\-Function\-Extremum}!LevMarq.h@{Lev\-Marq.\-h}}
\subsubsection[{fit\-Function\-Extremum}]{\setlength{\rightskip}{0pt plus 5cm}D\-E\-V\-I\-C\-E void fit\-Function\-Extremum (
\begin{DoxyParamCaption}
\item[{float $\ast$}]{param, }
\item[{float $\ast$}]{x}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{LevMarq_8h_a57031410d7214c2ce6569d26d313c81f}


fit\-Function\-Extremum returns the x of the min. or max. y value 


\begin{DoxyParams}{Parameters}
{\em param} & parameters to define the concrete current fit-\/function \\
\hline
{\em x} & the returned x value \\
\hline
\end{DoxyParams}
\hypertarget{LevMarq_8h_adf0c30c0f7827c9ec64081ead174e071}{\index{Lev\-Marq.\-h@{Lev\-Marq.\-h}!get\-Sample@{get\-Sample}}
\index{get\-Sample@{get\-Sample}!LevMarq.h@{Lev\-Marq.\-h}}
\subsubsection[{get\-Sample}]{\setlength{\rightskip}{0pt plus 5cm}template$<$unsigned int tex$>$ \-\_\-\-\_\-device\-\_\-\-\_\- float get\-Sample (
\begin{DoxyParamCaption}
\item[{float}]{I, }
\item[{int}]{I\-N\-D\-E\-X\-D\-A\-T\-A\-S\-E\-T}
\end{DoxyParamCaption}
)}}\label{LevMarq_8h_adf0c30c0f7827c9ec64081ead174e071}


get\-Sample returns the y value of a given sample index 


\begin{DoxyParams}{Parameters}
{\em I} & sample index \\
\hline
{\em I\-N\-D\-E\-X\-D\-A\-T\-A\-S\-E\-T} & index of the current dataset (G\-P\-U mode) or not used (C\-P\-U mode) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
y value 
\end{DoxyReturn}
\hypertarget{LevMarq_8h_acfe6a74e36f9c835b98e1773051de280}{\index{Lev\-Marq.\-h@{Lev\-Marq.\-h}!kernel@{kernel}}
\index{kernel@{kernel}!LevMarq.h@{Lev\-Marq.\-h}}
\subsubsection[{kernel}]{\setlength{\rightskip}{0pt plus 5cm}template$<$unsigned int tex$>$ G\-L\-O\-B\-A\-L void kernel (
\begin{DoxyParamCaption}
\item[{int}]{count\-Data, }
\item[{float}]{step, }
\item[{struct {\bf fit\-Data} $\ast$}]{result}
\end{DoxyParamCaption}
)}}\label{LevMarq_8h_acfe6a74e36f9c835b98e1773051de280}


kernel is the start method for calculation (you have to set the data\-Texture (G\-P\-U mode) or data variable (C\-P\-U mode) before calling this method) 


\begin{DoxyParams}{Parameters}
{\em count\-Data} & number of samples \\
\hline
{\em step} & the distance between two x values that are used to calculate the fit-\/function (if decimal then y values will be interpolated) \\
\hline
{\em result} & fit-\/function and other parameters, defined in \hyperlink{structfitData}{fit\-Data} struct \\
\hline
\end{DoxyParams}
\hypertarget{LevMarq_8h_a836594da02491db5779ce3d04f0574d2}{\index{Lev\-Marq.\-h@{Lev\-Marq.\-h}!lmdif@{lmdif}}
\index{lmdif@{lmdif}!LevMarq.h@{Lev\-Marq.\-h}}
\subsubsection[{lmdif}]{\setlength{\rightskip}{0pt plus 5cm}template$<$unsigned int tex$>$ D\-E\-V\-I\-C\-E void lmdif (
\begin{DoxyParamCaption}
\item[{int}]{m, }
\item[{int}]{n, }
\item[{float $\ast$}]{x, }
\item[{float $\ast$}]{fvec, }
\item[{float}]{ftol, }
\item[{float}]{xtol, }
\item[{float}]{gtol, }
\item[{int}]{maxfev, }
\item[{float}]{epsfcn, }
\item[{float $\ast$}]{diag, }
\item[{int}]{mode, }
\item[{float}]{factor, }
\item[{int $\ast$}]{info, }
\item[{int $\ast$}]{nfev, }
\item[{float $\ast$}]{fjac, }
\item[{int $\ast$}]{ipvt, }
\item[{float $\ast$}]{qtf, }
\item[{float $\ast$}]{wa1, }
\item[{float $\ast$}]{wa2, }
\item[{float $\ast$}]{wa3, }
\item[{float $\ast$}]{wa4, }
\item[{int}]{index\-Dataset, }
\item[{int}]{x\-Offset, }
\item[{float}]{x\-Step}
\end{DoxyParamCaption}
)}}\label{LevMarq_8h_a836594da02491db5779ce3d04f0574d2}


lmdif minimizes the sum of the squares of m nonlinear functions in n variables by a modification of the levenberg-\/marquardt algorithm 


\begin{DoxyParams}{Parameters}
{\em m} & number of samples \\
\hline
{\em n} & number of parameters \\
\hline
{\em x} & input\-: must contain an initial estimate of the solution vector; output\-: contains the final estimate of the solution vector \\
\hline
{\em fvec} & an output array of length m which contains the functions evaluated at the output x \\
\hline
{\em ftol} & measures the relative error desired in the sum of squares \\
\hline
{\em xtol} & measures the relative error desired in the approximate solution \\
\hline
{\em gtol} & gtol measures the orthogonality desired between the function vector and the columns of the jacobian \\
\hline
{\em maxfev} & a integer input variable that is used to terminate when the number of calls is at least maxfev by the end of an iteration \\
\hline
{\em epsfcn} & an input variable used in determining a suitable step length for the forward-\/difference approximation \\
\hline
{\em mode} & if mode = 1 then the variables will be scaled internally, if mode = 2 then the scaling is specified by the input diag \\
\hline
{\em factor} & a input variable used in determining the initial step bound. This bound is set to the product of factor and the euclidean norm of diag$\ast$x \\
\hline
{\em info} & an integer output variable that indicates the termination status of lmdif (see status\-Message) \\
\hline
{\em nfev} & an output variable set to the number of calls to the user-\/supplied routine $\ast$evaluate \\
\hline
{\em fjac} & an output m by n array. The upper n by n submatrix of fjac contains an upper triangular matrix r with diagonal elements of nonincreasing magnitude \\
\hline
{\em ipvt} & an integer output array of length n that defines a permutation matrix p such that jac$\ast$p = q$\ast$r \\
\hline
{\em qtf} & an output array of length n which contains the first n elements of the vector (q transpose)$\ast$fvec \\
\hline
{\em wa1} & work array of length n \\
\hline
{\em wa2} & work array of length n \\
\hline
{\em wa3} & work array of length n \\
\hline
{\em wa4} & work array of length m \\
\hline
{\em index\-Dataset} & index of the current dataset (G\-P\-U mode) or not used (C\-P\-U mode) \\
\hline
{\em x\-Offset} & first x value that is used to calculate the fit-\/function \\
\hline
{\em x\-Step} & the distance between two x values that are used to calculate the fit-\/function (if decimal then y values will be interpolated) \\
\hline
\end{DoxyParams}
\hypertarget{LevMarq_8h_abb75a88e4f290d8df4960dcaa63439e2}{\index{Lev\-Marq.\-h@{Lev\-Marq.\-h}!lmpar@{lmpar}}
\index{lmpar@{lmpar}!LevMarq.h@{Lev\-Marq.\-h}}
\subsubsection[{lmpar}]{\setlength{\rightskip}{0pt plus 5cm}D\-E\-V\-I\-C\-E void lmpar (
\begin{DoxyParamCaption}
\item[{int}]{n, }
\item[{float $\ast$}]{r, }
\item[{int}]{ldr, }
\item[{int $\ast$}]{ipvt, }
\item[{float $\ast$}]{diag, }
\item[{float $\ast$}]{qtb, }
\item[{float}]{delta, }
\item[{float $\ast$}]{par, }
\item[{float $\ast$}]{x, }
\item[{float $\ast$}]{sdiag, }
\item[{float $\ast$}]{wa1, }
\item[{float $\ast$}]{wa2}
\end{DoxyParamCaption}
)}}\label{LevMarq_8h_abb75a88e4f290d8df4960dcaa63439e2}


lmpar determines a value for the parameter par such that x solves the system 


\begin{DoxyParams}{Parameters}
{\em n} & width and height of array r \\
\hline
{\em ldr} & a positive integer input variable not less than n which specifies the leading dimension of the array r \\
\hline
{\em ipvt} & an integer input array of length n which defines the permutation matrix p such that a$\ast$p = q$\ast$r \\
\hline
{\em diag} & an input array of length n which must contain the diagonal elements of the matrix d \\
\hline
{\em qtb} & an input array of length n which must contain the first n elements of the vector (q transpose)$\ast$b \\
\hline
{\em delta} & a positive input variable which specifies an upper bound on the euclidean norm of d$\ast$x \\
\hline
{\em par} & input\-: contains an initial estimate of the levenberg-\/marquardt parameter; output\-: contains the final estimate \\
\hline
{\em x} & an output array of length n which contains the least squares solution of the system a$\ast$x = b, d$\ast$x = 0 \\
\hline
{\em sdiag} & an output array of length n which contains the diagonal elements of the upper triangular matrix s \\
\hline
{\em wa1} & work array of length n \\
\hline
{\em wa2} & work array of length n \\
\hline
\end{DoxyParams}
\hypertarget{LevMarq_8h_a8694039b8a2d6041fd6a6ccffea8b5a4}{\index{Lev\-Marq.\-h@{Lev\-Marq.\-h}!max\-Value@{max\-Value}}
\index{max\-Value@{max\-Value}!LevMarq.h@{Lev\-Marq.\-h}}
\subsubsection[{max\-Value}]{\setlength{\rightskip}{0pt plus 5cm}template$<$unsigned int tex$>$ D\-E\-V\-I\-C\-E void max\-Value (
\begin{DoxyParamCaption}
\item[{int}]{count\-Data, }
\item[{int}]{index\-Dataset, }
\item[{int $\ast$}]{x, }
\item[{D\-A\-T\-A\-T\-Y\-P\-E $\ast$}]{y}
\end{DoxyParamCaption}
)}}\label{LevMarq_8h_a8694039b8a2d6041fd6a6ccffea8b5a4}


max\-Value returns the x and y where y has the greatest value 


\begin{DoxyParams}{Parameters}
{\em count\-Data} & number of samples \\
\hline
{\em index\-Dataset} & index of the current dataset (G\-P\-U mode) or not used (C\-P\-U mode) \\
\hline
{\em x} & the returned x value \\
\hline
{\em y} & the returned y value \\
\hline
\end{DoxyParams}
\hypertarget{LevMarq_8h_a682db89fc9fd71fc08af4c6bf97b8a67}{\index{Lev\-Marq.\-h@{Lev\-Marq.\-h}!param\-Start\-Value@{param\-Start\-Value}}
\index{param\-Start\-Value@{param\-Start\-Value}!LevMarq.h@{Lev\-Marq.\-h}}
\subsubsection[{param\-Start\-Value}]{\setlength{\rightskip}{0pt plus 5cm}template$<$unsigned int tex$>$ D\-E\-V\-I\-C\-E void param\-Start\-Value (
\begin{DoxyParamCaption}
\item[{int}]{first\-Value, }
\item[{int}]{last\-Value, }
\item[{int}]{index\-Dataset, }
\item[{float $\ast$}]{param}
\end{DoxyParamCaption}
)}}\label{LevMarq_8h_a682db89fc9fd71fc08af4c6bf97b8a67}


param\-Start\-Value returns the parameter start values for the fit-\/function calculation 


\begin{DoxyParams}{Parameters}
{\em first\-Value} & first value of the data used for fit-\/function \\
\hline
{\em last\-Value} & last value of the data used for fit-\/function \\
\hline
{\em index\-Dataset} & index of the current dataset (G\-P\-U mode) or not used (C\-P\-U mode) \\
\hline
{\em param} & the returned parameter start values \\
\hline
\end{DoxyParams}
\hypertarget{LevMarq_8h_a15b9d544dbbe5defd5987e65cc6d934e}{\index{Lev\-Marq.\-h@{Lev\-Marq.\-h}!qr\-Factorization@{qr\-Factorization}}
\index{qr\-Factorization@{qr\-Factorization}!LevMarq.h@{Lev\-Marq.\-h}}
\subsubsection[{qr\-Factorization}]{\setlength{\rightskip}{0pt plus 5cm}D\-E\-V\-I\-C\-E void qr\-Factorization (
\begin{DoxyParamCaption}
\item[{int}]{m, }
\item[{int}]{n, }
\item[{float $\ast$}]{a, }
\item[{int}]{pivot, }
\item[{int $\ast$}]{ipvt, }
\item[{float $\ast$}]{rdiag, }
\item[{float $\ast$}]{acnorm, }
\item[{float $\ast$}]{wa}
\end{DoxyParamCaption}
)}}\label{LevMarq_8h_a15b9d544dbbe5defd5987e65cc6d934e}


qr\-Factorization uses householder transformations with column pivoting (optional) to compute a qr factorization of the m by n matrix a 


\begin{DoxyParams}{Parameters}
{\em m} & height of array a \\
\hline
{\em n} & width of array a \\
\hline
{\em a} & input\-: contains the matrix for which the qr factorization is to be computed; output\-: the strict upper trapezoidal part of a contains the strict upper trapezoidal part of r, and the lower trapezoidal part of a contains a factored form of q \\
\hline
{\em pivot} & if is set true then column pivoting is enforced; if is set false then no column pivoting is done \\
\hline
{\em ipvt} & defines the permutation matrix p such that a$\ast$p = q$\ast$r \\
\hline
{\em rdiag} & an output array of length n which contains the diagonal elements of r \\
\hline
{\em acnorm} & an output array of length n which contains the norms of the corresponding columns of the input matrix a \\
\hline
{\em wa} & work array of length n \\
\hline
\end{DoxyParams}
\hypertarget{LevMarq_8h_aaa2c225ad735dbaf4b949124356c7680}{\index{Lev\-Marq.\-h@{Lev\-Marq.\-h}!qr\-Solve@{qr\-Solve}}
\index{qr\-Solve@{qr\-Solve}!LevMarq.h@{Lev\-Marq.\-h}}
\subsubsection[{qr\-Solve}]{\setlength{\rightskip}{0pt plus 5cm}D\-E\-V\-I\-C\-E void qr\-Solve (
\begin{DoxyParamCaption}
\item[{int}]{n, }
\item[{float $\ast$}]{r, }
\item[{int}]{ldr, }
\item[{int $\ast$}]{ipvt, }
\item[{float $\ast$}]{diag, }
\item[{float $\ast$}]{qtb, }
\item[{float $\ast$}]{x, }
\item[{float $\ast$}]{sdiag, }
\item[{float $\ast$}]{wa}
\end{DoxyParamCaption}
)}}\label{LevMarq_8h_aaa2c225ad735dbaf4b949124356c7680}


qr\-Solve completes the solution of the problem if it is provided with the necessary information from the qr factorization, with column pivoting, of a 


\begin{DoxyParams}{Parameters}
{\em n} & width and height of array r \\
\hline
{\em ldr} & a positive integer input variable not less than n which specifies the leading dimension of the array r \\
\hline
{\em ipvt} & an integer input array of length n which defines the permutation matrix p such that a$\ast$p = q$\ast$r \\
\hline
{\em diag} & an input array of length n which must contain the diagonal elements of the matrix d \\
\hline
{\em qtb} & an input array of length n which must contain the first n elements of the vector (q transpose)$\ast$b \\
\hline
{\em x} & an output array of length n which contains the least squares solution of the system a$\ast$x = b, d$\ast$x = 0 \\
\hline
{\em sdiag} & an output array of length n which contains the diagonal elements of the upper triangular matrix s \\
\hline
{\em wa} & work array of length n \\
\hline
\end{DoxyParams}
\hypertarget{LevMarq_8h_adc2eca95c3a57907e8f4a3b5ac74dad3}{\index{Lev\-Marq.\-h@{Lev\-Marq.\-h}!x\-Of\-Value@{x\-Of\-Value}}
\index{x\-Of\-Value@{x\-Of\-Value}!LevMarq.h@{Lev\-Marq.\-h}}
\subsubsection[{x\-Of\-Value}]{\setlength{\rightskip}{0pt plus 5cm}template$<$unsigned int tex$>$ D\-E\-V\-I\-C\-E void x\-Of\-Value (
\begin{DoxyParamCaption}
\item[{int}]{count\-Data, }
\item[{int}]{index\-Dataset, }
\item[{char}]{from\-Direction, }
\item[{D\-A\-T\-A\-T\-Y\-P\-E}]{min\-Value, }
\item[{int $\ast$}]{x}
\end{DoxyParamCaption}
)}}\label{LevMarq_8h_adc2eca95c3a57907e8f4a3b5ac74dad3}


x\-Of\-Value returns the first x of a value y that is greater or equal of a given min. value 


\begin{DoxyParams}{Parameters}
{\em count\-Data} & number of samples \\
\hline
{\em index\-Dataset} & index of the current dataset (G\-P\-U mode) or not used (C\-P\-U mode) \\
\hline
{\em from\-Direction} & \\
\hline
{\em min\-Value} & min. y value \\
\hline
{\em x} & the returned x value, -\/1 if there is no x with a y greater or equal min\-Value \\
\hline
\end{DoxyParams}


\subsection{Variable Documentation}
\hypertarget{LevMarq_8h_a566842bb6e232f37419d0ac24e4618b1}{\index{Lev\-Marq.\-h@{Lev\-Marq.\-h}!status\-Message@{status\-Message}}
\index{status\-Message@{status\-Message}!LevMarq.h@{Lev\-Marq.\-h}}
\subsubsection[{status\-Message}]{\setlength{\rightskip}{0pt plus 5cm}const char$\ast$ status\-Message\mbox{[}$\,$\mbox{]}}}\label{LevMarq_8h_a566842bb6e232f37419d0ac24e4618b1}
{\bfseries Initial value\-:}
\begin{DoxyCode}
 \{ 
    \textcolor{stringliteral}{"fatal coding error (improper input parameters)"},
    \textcolor{stringliteral}{"success (the relative error in the sum of squares is at most tol)"},
    \textcolor{stringliteral}{"success (the relative error between x and the solution is at most tol)"},
    \textcolor{stringliteral}{"success (the relative errors in the sum of squares and between x and the
       solution are at most tol)"},
    \textcolor{stringliteral}{"trapped by degeneracy (fvec is orthogonal to the columns of the jacobian)"}
      ,
    \textcolor{stringliteral}{"timeout (number of calls to fcn has reached maxcall*(n+1))"},
    \textcolor{stringliteral}{"failure (ftol<tol: cannot reduce sum of squares any further)"},
    \textcolor{stringliteral}{"failure (xtol<tol: cannot improve approximate solution any further)"},
    \textcolor{stringliteral}{"failure (gtol<tol: cannot improve approximate solution any further)"}
\}
\end{DoxyCode}
